#!/bin/bash

# List of Pokémon
pokemon_list=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

# Base API URL
BASE_URL="https://pokeapi.co/api/v2/pokemon"

# Error log
ERROR_FILE="errors.txt"
> "$ERROR_FILE"  # Clear old log

# Function to fetch one Pokémon
fetch_pokemon() {
  name=$1
  url="${BASE_URL}/${name}"
  file="${name}.json"

  echo "Fetching $name..."
  response=$(curl -s -w "%{http_code}" -o "$file" "$url")
  status="${response: -3}"

  if [ "$status" -eq 200 ]; then
    echo "Fetched $name successfully."
  else
    echo "Failed to fetch $name (status $status)" | tee -a "$ERROR_FILE"
    echo "Timestamp: $(date)" >> "$ERROR_FILE"
  fi
}

# Fetch all Pokémon in parallel
for pokemon in "${pokemon_list[@]}"; do
  fetch_pokemon "$pokemon" &
done

# Wait for all background jobs to complete
wait

echo "All fetch operations completed."
